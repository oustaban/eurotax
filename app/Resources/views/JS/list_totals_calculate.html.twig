{% block totalsCalculate %}
<script type="text/javascript">
    $(function () {
        var $table = $('.sonata-ba-list .table tbody:first')
        var $tr = $table.find('tr:first').clone();

        var add_total_rows = false;
        $tr.addClass('totals_row').children().each(function () {
            $(this).addClass('total').removeAttr('objectid');
            var $div = $(this).children();
            if (!$div.hasClass('totals')) {
                $(this).html('&nbsp;');
            }
            else {
                add_total_rows = true;
                var tc = $div.removeClass('totals')
                        .attr("class");
                $div.attr("class", tc + '_total')

                var sum = 0;
                $('.' + tc).each(function () {
                    sum += parseFloat($(this).html());
                });
                $div.html('<b>Total:<br/>' + sum + '</b>');
            }
        });

        if (add_total_rows) {
            $tr.appendTo($table);
        }
        else {
            $tr.remove();
        }
    });
</script>
{% endblock totalsCalculate %}