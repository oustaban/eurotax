{% extends 'ApplicationSonataDashboardBundle::layout.html.twig' %}

{% set label_all_clients = cookies.get('show_all_clients')==cookies.get('PHPSESSID') ? 'hide_projects' : 'show_projects' %}

{% block body_content %}
{{ parent() }}
<div style="clear:both;float: none;">
    <h2>SÃ©lectionnez le client</h2>

    <div style="float: left; margin-bottom: 10px;clear: both;">
        {% if alert_count %}
        <div class="alert-count"></i> {% trans with {'%count%': alert_count } %}Attention, %count% alertes en
            cours{% endtrans %}</div>
        {% endif %}
        <button id="show_hide_all_clients" class="btn">{{ ('ApplicationSonataDashboardBundle.index.'~label_all_clients)|trans() }}
            ...
        </button>
    </div>
</div>
<div style="clear:both;float: none;" class="sonata-ba-list">
    {% if clients %}
    <table id="clientList" class="table table-bordered table-striped table-hover" style="width: auto;">
        {% block table_header %}
        <thead>
        <tr class="sonata-ba-list-field-header">
            {% spaceless %}
            <th class="sonata-ba-list-field-header-text">
                <a href="#">{{ 'list.code_client'|trans() }}</a>
            </th>
            <th class="sonata-ba-list-field-header-text headerSortUp">
                <a href="#">{{ 'list.raison_sociale'|trans() }}</a>
            </th>
            <th class="sonata-ba-list-field-header-text">
                <a href="#">{{ 'list.nature_du_client'|trans() }}</a>
            </th>
            <th class="sonata-ba-list-field-header-text">
                <a href="#">{{ 'list.user'|trans() }}</a>
            </th>
            <th class="sonata-ba-list-field-header-text">
                <a href="#">{{ 'list.center_des_impots'|trans() }}</a>
            </th>
            <th class="sonata-ba-list-field-header-integer">
                <a href="#">{{ 'list.date_de_depot_id'|trans() }}</a>
            </th>
            <th class="sonata-ba-list-field-header-boolean">
                <a href="#">{{ 'list.teledeclaration'|trans() }}</a>
            </th>
            <th class="sonata-ba-list-field-header-text">
                <a href="#">{{ 'list.mois_tva'|trans() }}</a>
            </th>
            <th class="sonata-ba-list-field-header-text">
                <a href="#">{{ 'list.BAPSA'|trans() }}</a>
            </th>
            <th class="sonata-ba-list-field-header-text">
                <a href="#">{{ 'list.solde_du_compte'|trans() }}</a>
            </th>
            <th class="sonata-ba-list-field-header-text">
                <a href="#">{{ 'list.remboursement_de_TVA'|trans() }}</a>
            </th>
            <th class="sonata-ba-list-field-header-date">
                <a href="#">{{ 'list.date_debut_mission'|trans() }}</a>
            </th>
            <th class="sonata-ba-list-field-header-date">
                <a href="#">{{ 'list.date_fin_mission'|trans() }}</a>
            </th>
            {% endspaceless %}
        </tr>
        </thead>
        {% endblock %}

        {% block table_body %}
        <tbody>
        {% for client in clients %}
        <tr class="{% if client.dimmed%}dimmed{% endif %}">
            <td class="sonata-ba-list-field sonata-ba-list-field-text"  objectId="{{ client[0].id }}">
                {{ client[0].getCodeClient }}
            </td>
            <td class="sonata-ba-list-field sonata-ba-list-field-text"  objectId="{{ client[0].id }}">
                {{ client[0].getRaisonSociale }}
            </td>
            <td class="sonata-ba-list-field sonata-ba-list-field-text"  objectId="{{ client[0].id }}">
                {{ client[0].getNatureDuClient }}
            </td>
            <td class="sonata-ba-list-field sonata-ba-list-field-text"  objectId="{{ client[0].id }}">
                {{ client[0].user }}
            </td>
            <td class="sonata-ba-list-field sonata-ba-list-field-text"  objectId="{{ client[0].id }}">
                {{ client[0].getCenterDesImpots }}
            </td>
            <td class="sonata-ba-list-field sonata-ba-list-field-integer"  objectId="{{ client[0].id }}">
                {{ client[0].getDateDeDepot }}
            </td>
            <td class="sonata-ba-list-field sonata-ba-list-field-boolean"  objectId="{{ client[0].id }}">
                {% set img = client[0].teledeclaration ? 'accept' : 'exclamation' %}
                <img alt="{{ ('ApplicationSonataDashboardBundle.alt.' ~ img)|trans() }}" src="{{ asset('/bundles/sonataadmin/famfamfam/' ~ img|trans() ~ '.png') }}">
            </td>
            <td class="sonata-ba-list-field sonata-ba-list-field-text"  objectId="{{ client[0].id }}">
                {#{{ client[0].mois_tva }}#}
            </td>
            <td class="sonata-ba-list-field sonata-ba-list-field-text"  objectId="{{ client[0].id }}">
                {#{{ client[0].BAPSA }}#}
            </td>
            <td class="sonata-ba-list-field sonata-ba-list-field-text"  objectId="{{ client[0].id }}">
                {#{{ client[0].solde_du_compte }}#}
            </td>
            <td class="sonata-ba-list-field sonata-ba-list-field-text"  objectId="{{ client[0].id }}">
                {#{{ client[0].remboursement_de_TVA }}#}
            </td>
            <td class="sonata-ba-list-field sonata-ba-list-field-date"  objectId="{{ client[0].id }}">
                {{ client[0].getDateDebutMission|datefmt_format(default_date_format) }}
            </td>
            <td class="sonata-ba-list-field sonata-ba-list-field-date"  objectId="{{ client[0].id }}">
                {{ client[0].getDateFinMission|datefmt_format(default_date_format) }}
            </td>
        </tr>
        {% endfor %}
        </tbody>
        {% endblock %}
    </table>
    {% endif %}
</div>
{% endblock body_content %}

{% block javascripts %}
{{parent()}}
<script src="{{ asset('bundles/applicationsonataclientoperations/js/jquery.tablesorter.js') }}" type="text/javascript"></script>
<script src="{{ asset('bundles/applicationsonataclientoperations/js/jquery.columnfilters.js') }}" type="text/javascript"></script>
<script type="text/javascript">
    var editObjectAbstractUrl = '{{ path('admin_sonata_clientoperations_v01tva_list', {'filter[client_id][value]' : '__id__'}) }}';
    init_home_page();
</script>
{% endblock javascripts %}

{% block javascriptsafter %}
{{ parent()}}
<script type="text/javascript">
    $(function () {
        tableFixLayout();
    });
</script>
{% endblock javascriptsafter %}